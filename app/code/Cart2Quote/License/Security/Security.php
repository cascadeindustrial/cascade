<?php
 namespace Cart2Quote\License\Security; use Cart2Quote\License\Security\Crypto\Mcrypt; use Cart2Quote\License\Security\Crypto\OpenSsl; use InvalidArgumentException; final class Security { public static $Y26Bi = "\x73\x68\x61\61"; protected static $pCrg0; protected static $VksZb; public static function setHash($QS2DU) { static::$Y26Bi = $QS2DU; } public static function randomBytes($pua9p) { goto rva1u; AvzMh: return $D0fuo; goto GTV1X; e1tG2: trigger_error("\131\157\165\x20\144\x6f\x20\x6e\157\164\x20\150\x61\166\x65\40\141\x20\163\141\146\x65\x20\163\x6f\165\x72\143\x65\x20\x6f\146\40\x72\141\156\144\157\155\40\144\141\164\141\40\x61\166\141\151\x6c\x61\142\x6c\145\56\40" . "\111\156\x73\x74\x61\154\x6c\x20\145\151\x74\x68\145\162\40\164\x68\x65\x20\157\160\x65\156\x73\x73\154\x20\x65\x78\164\145\x6e\x73\151\157\156\x2c\x20\157\162\40\x70\141\162\x61\x67\x6f\x6e\x69\x65\57\162\141\156\x64\x6f\155\137\143\157\155\x70\141\x74\x2e\x20" . "\106\x61\154\154\151\156\147\x20\142\x61\x63\153\40\164\157\x20\141\x6e\40\151\x6e\x73\145\143\165\162\x65\x20\162\x61\x6e\x64\157\x6d\40\x73\x6f\165\x72\x63\145\56", E_USER_WARNING); goto JChyZ; XkPeP: return random_bytes($pua9p); goto a1VuG; jFb5G: if ($aoC2Z) { goto PP2Hz; } goto vF20y; Pwhcx: PP2Hz: goto AvzMh; vF20y: trigger_error("\x6f\160\x65\156\x73\163\154\x20\x77\x61\163\40\x75\156\x61\142\154\145\40\164\157\40\165\x73\x65\40\141\40\x73\164\x72\157\x6e\x67\40\163\157\x75\x72\x63\x65\x20\157\146\x20\x65\x6e\164\x72\157\160\x79\56\40" . "\103\157\x6e\163\151\x64\145\x72\x20\165\x70\144\x61\164\151\156\x67\40\171\157\165\162\x20\163\171\x73\x74\x65\x6d\40\154\151\142\162\x61\x72\151\145\x73\54\40\157\162\x20\x65\156\x73\x75\162\x69\156\x67\x20" . "\x79\157\165\x20\150\141\x76\145\x20\155\157\x72\x65\x20\x61\x76\141\x69\154\141\x62\154\145\x20\145\x6e\164\x72\157\160\171\56", E_USER_WARNING); goto Pwhcx; GTV1X: eEFMm: goto e1tG2; b7xh0: if (!function_exists("\157\x70\x65\x6e\163\163\x6c\x5f\162\141\x6e\x64\x6f\155\137\x70\163\x65\165\x64\157\137\x62\x79\x74\x65\x73")) { goto eEFMm; } goto Ac3RA; a1VuG: L9Cln: goto b7xh0; JChyZ: return static::insecureRandomBytes($pua9p); goto pAydo; Ac3RA: $D0fuo = openssl_random_pseudo_bytes($pua9p, $aoC2Z); goto jFb5G; rva1u: if (!function_exists("\x72\x61\156\x64\157\x6d\137\x62\171\164\145\163")) { goto L9Cln; } goto XkPeP; pAydo: } public static function insecureRandomBytes($pua9p) { goto nAX7M; ruM1e: $GGosi = 0; goto yTjMJ; gv4qK: $D0fuo = ''; goto ruM1e; idHOm: return pack("\110\x2a", $D0fuo); goto HJimm; Na1QZ: EIvL8: goto RyLQ0; cHCjo: goto a1Zhc; goto Na1QZ; yTjMJ: a1Zhc: goto eyB0f; nAX7M: $pua9p *= 2; goto gv4qK; eyB0f: if (!($GGosi < $pua9p)) { goto EIvL8; } goto vGJEY; RyLQ0: $D0fuo = substr($D0fuo, 0, $pua9p); goto idHOm; gZzpm: $GGosi = strlen($D0fuo); goto cHCjo; vGJEY: $D0fuo .= static::hash(Text::uuid() . uniqid(mt_rand(), true), "\163\150\x61\65\61\x32", true); goto gZzpm; HJimm: } public static function hash($RqhXe, $LLa1f = null, $E_Opf = false) { goto FH7Ri; fi6mJ: $RqhXe = $E_Opf . $RqhXe; goto qY_3M; FH7Ri: if (!empty($LLa1f)) { goto YVM1O; } goto oNabZ; IdCE3: YVM1O: goto YQ9Av; yi0Od: if (!$E_Opf) { goto XT8wr; } goto Dmz_v; RXOto: $E_Opf = static::$pCrg0; goto nmJ2A; Dmz_v: if (is_string($E_Opf)) { goto dyuIK; } goto RXOto; qY_3M: XT8wr: goto gCmhE; oNabZ: $LLa1f = static::$Y26Bi; goto IdCE3; YQ9Av: $LLa1f = strtolower($LLa1f); goto yi0Od; gCmhE: return hash($LLa1f, $RqhXe); goto mZyvE; nmJ2A: dyuIK: goto fi6mJ; mZyvE: } public static function rijndael($Gbe2K, $qe5AW, $AjLWF) { goto SjjwC; J24Nc: throw new InvalidArgumentException("\x59\157\165\x20\155\165\163\x74\40\x75\x73\x65\40\141\x20\x6b\145\x79\x20\154\141\x72\x67\145\162\x20\x74\x68\141\156\x20\x33\62\x20\x62\171\x74\145\x73\x20\146\157\162\x20\x53\x65\143\165\162\151\164\x79\x3a\72\x72\x69\152\x6e\144\141\145\x6c\x28\51"); goto MGLYX; E6oq9: if (!(mb_strlen($qe5AW, "\70\142\x69\164") < 32)) { goto daQqh; } goto J24Nc; eN_6G: throw new InvalidArgumentException("\x59\157\165\40\x63\x61\156\x6e\157\x74\40\165\163\145\x20\x61\x6e\40\x65\155\160\164\x79\x20\x6b\x65\x79\x20\146\157\x72\x20\x53\x65\x63\165\162\x69\164\x79\72\x3a\162\x69\x6a\156\144\141\145\154\50\x29"); goto F7cCY; SjjwC: if (!empty($qe5AW)) { goto movj5; } goto eN_6G; aVzAr: vEto4: goto E6oq9; F7cCY: movj5: goto l5q33; xF5Ct: return $jlgQo->rijndael($Gbe2K, $qe5AW, $AjLWF); goto hBMuS; XteL1: throw new InvalidArgumentException("\131\157\165\x20\x6d\x75\163\x74\x20\x73\x70\x65\143\x69\146\171\40\x74\x68\x65\40\x6f\160\145\162\141\164\151\157\x6e\x20\146\x6f\162\x20\123\145\x63\165\162\151\164\x79\72\72\162\x69\152\x6e\144\141\145\154\x28\x29\54\40\x65\x69\x74\x68\145\x72\40\x65\156\x63\x72\x79\160\164\40\x6f\x72\40\x64\x65\x63\162\171\x70\164"); goto aVzAr; swUc0: $jlgQo = static::engine(); goto xF5Ct; MGLYX: daQqh: goto swUc0; l5q33: if (!(empty($AjLWF) || !in_array($AjLWF, ["\145\156\x63\162\x79\160\164", "\144\145\x63\162\171\160\x74"]))) { goto vEto4; } goto XteL1; hBMuS: } public static function engine($Yv7nK = null) { goto HQG77; hGYF5: $Yv7nK = new Mcrypt(); goto GUYhM; WXM42: KAUMQ: goto LJW23; j6Bnf: if (extension_loaded("\157\x70\x65\156\x73\x73\x6c")) { goto eFQ46; } goto zWrK5; rqeaq: throw new InvalidArgumentException("\116\157\40\143\157\155\x70\x61\164\151\142\154\145\40\x63\x72\171\160\164\x6f\x20\145\x6e\x67\x69\x6e\x65\x20\141\166\141\151\x6c\x61\142\154\145\x2e\x20" . "\114\x6f\141\144\x20\145\151\164\x68\x65\x72\40\164\x68\x65\x20\x6f\160\145\156\163\x73\154\x20\x6f\x72\40\x6d\143\x72\171\160\x74\x20\x65\170\x74\145\x6e\x73\151\157\x6e\163"); goto USA8E; IkCIP: $Yv7nK = new OpenSsl(); goto P4Akz; FKcKX: qFJi1: goto hGYF5; qtPeJ: eFQ46: goto IkCIP; hYsjN: return static::$VksZb; goto jO7od; HQG77: if (!($Yv7nK === null && static::$VksZb === null)) { goto sALOi; } goto j6Bnf; P4Akz: goto y7CSc; goto FKcKX; GUYhM: y7CSc: goto VR2yP; LJW23: if (!isset(static::$VksZb)) { goto TUgyW; } goto hYsjN; N5eBe: if (!$Yv7nK) { goto KAUMQ; } goto smifu; smifu: static::$VksZb = $Yv7nK; goto WXM42; VR2yP: sALOi: goto N5eBe; zWrK5: if (extension_loaded("\x6d\x63\x72\x79\160\164")) { goto qFJi1; } goto imPpS; jO7od: TUgyW: goto rqeaq; imPpS: goto y7CSc; goto qtPeJ; USA8E: } public static function encrypt($dvR7W, $qe5AW, $kuP2k = null) { goto NT5mY; w_TVA: nwSVP: goto PmqTJ; NT5mY: self::_checkKey($qe5AW, "\145\156\x63\162\x79\160\x74\x28\51"); goto boeOx; boeOx: if (!($kuP2k === null)) { goto nwSVP; } goto EZ7x8; UCw2C: return $jhA92 . $y9HwS; goto V1KhN; EZ7x8: $kuP2k = static::$pCrg0; goto w_TVA; PmqTJ: $qe5AW = mb_substr(hash("\163\x68\141\62\x35\x36", $qe5AW . $kuP2k), 0, 32, "\70\142\x69\x74"); goto aEd2G; aEd2G: $jlgQo = static::engine(); goto WDtNi; WDtNi: $y9HwS = $jlgQo->encrypt($dvR7W, $qe5AW); goto QA6Cu; QA6Cu: $jhA92 = hash_hmac("\163\x68\141\x32\65\x36", $y9HwS, $qe5AW); goto UCw2C; V1KhN: } protected static function _checkKey($qe5AW, $xZrL6) { goto pNZeA; L3Qpi: throw new InvalidArgumentException(sprintf("\111\x6e\166\x61\x6c\151\x64\x20\153\145\171\40\x66\x6f\x72\x20\45\x73\x2c\x20\x6b\145\x79\40\155\x75\x73\x74\40\142\145\40\x61\x74\x20\x6c\x65\x61\x73\x74\x20\x32\65\66\40\x62\x69\164\x73\40\x28\x33\x32\x20\x62\x79\x74\145\163\x29\40\x6c\157\156\x67\x2e", $xZrL6)); goto rkgMt; pNZeA: if (!(mb_strlen($qe5AW, "\70\x62\151\164") < 32)) { goto fgviS; } goto L3Qpi; rkgMt: fgviS: goto WbI4g; WbI4g: } public static function decrypt($nXfGd, $qe5AW, $kuP2k = null) { goto i4cQ_; CRxSB: return false; goto Cy9jM; N2CD_: if (!empty($nXfGd)) { goto HVzfX; } goto oyFMu; i4cQ_: self::_checkKey($qe5AW, "\x64\145\143\x72\x79\160\x74\50\x29"); goto N2CD_; lR1s1: HVzfX: goto Jwcl4; wZp9j: $kuP2k = static::$pCrg0; goto FchbB; dBflf: $StKC2 = 64; goto me21v; FchbB: FHa_z: goto UO1fL; RpF0H: return $jlgQo->decrypt($nXfGd, $qe5AW); goto nXpud; oyFMu: throw new InvalidArgumentException("\124\x68\145\x20\144\x61\x74\141\x20\x74\x6f\40\x64\x65\x63\162\x79\x70\x74\40\x63\141\156\156\157\x74\x20\142\145\40\145\x6d\160\164\171\56"); goto lR1s1; zRoqE: $jlgQo = static::engine(); goto RpF0H; Cy9jM: xE2BC: goto zRoqE; me21v: $jhA92 = mb_substr($nXfGd, 0, $StKC2, "\70\142\x69\x74"); goto b2H95; Jwcl4: if (!($kuP2k === null)) { goto FHa_z; } goto wZp9j; b2H95: $nXfGd = mb_substr($nXfGd, $StKC2, null, "\70\142\x69\x74"); goto GrD4r; GrD4r: $mWvDj = hash_hmac("\x73\150\x61\62\65\x36", $nXfGd, $qe5AW); goto b0J1c; b0J1c: if (static::_constantEquals($jhA92, $mWvDj)) { goto xE2BC; } goto CRxSB; UO1fL: $qe5AW = mb_substr(hash("\x73\x68\x61\x32\65\66", $qe5AW . $kuP2k), 0, 32, "\x38\x62\151\x74"); goto dBflf; nXpud: } protected static function _constantEquals($jhA92, $uo9qF) { goto V0RHv; qEmH4: $PX0Uc |= ord($jhA92[$u4tfo]) ^ ord($uo9qF[$u4tfo]); goto ABB1f; Lti3F: if (!($u4tfo < $WgHXC)) { goto ndK3n; } goto qEmH4; ZSIJY: IscZ3: goto lGEoy; eDR_l: if (!($WgHXC !== $u67Ab)) { goto IscZ3; } goto t7V6d; ABB1f: CaI20: goto tAY3Z; Krjc9: IVlRq: goto Lti3F; N2LpZ: goto IVlRq; goto Ixc7V; ne0YF: $WgHXC = mb_strlen($jhA92, "\x38\x62\151\164"); goto Qo2Vz; XBIx9: Lx3Cv: goto ne0YF; Qo2Vz: $u67Ab = mb_strlen($uo9qF, "\x38\142\x69\x74"); goto eDR_l; tAY3Z: $u4tfo++; goto N2LpZ; WrJok: return hash_equals($jhA92, $uo9qF); goto XBIx9; l3wPm: $u4tfo = 0; goto Krjc9; lGEoy: $PX0Uc = 0; goto l3wPm; Ixc7V: ndK3n: goto wvyqU; wvyqU: return $PX0Uc === 0; goto zaioH; V0RHv: if (!function_exists("\x68\x61\x73\x68\x5f\145\161\165\x61\x6c\x73")) { goto Lx3Cv; } goto WrJok; t7V6d: return false; goto ZSIJY; zaioH: } public static function getSalt() { return static::$pCrg0; } public static function setSalt($E_Opf) { static::$pCrg0 = (string) $E_Opf; } public static function salt($E_Opf = null) { goto iAMMU; sAMGK: wMk86: goto MbWAZ; MbWAZ: return static::$pCrg0 = (string) $E_Opf; goto qdXx2; liPyV: return static::$pCrg0; goto sAMGK; iAMMU: if (!($E_Opf === null)) { goto wMk86; } goto liPyV; qdXx2: } }