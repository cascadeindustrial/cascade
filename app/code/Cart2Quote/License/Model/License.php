<?php
 namespace Cart2Quote\License\Model; final class License implements \Cart2Quote\Quotation\Model\LicenseInterface { const INACTIVE_STATE = "\x69\156\141\143\x74\151\166\145"; const PENDING_STATE = "\x70\145\156\144\x69\x6e\147"; const ACTIVE_STATE = "\141\143\x74\x69\x76\145"; const UNREACHABLE = "\x75\156\162\x65\141\x63\x68\x61\x62\x6c\x65"; const ALLOWED_PROPOSAL_AMOUNT = 15; private $f1Xdh = "\103\x41\x52\124\x32\121\x55\x4f\124\x45\137\x51\125\117\x54\x41\124\111\117\x4e\x5f\x4c\x49\x43\105\x4e\x53\105\137\103\x41\x43\110\105"; private $UNlJY = "\152\x71\x78\126\147\142\x7a\x39\157\x33\x76\130\60\66\104\116\x39\x38\x38\102\x57\127\151\x4c\163\x79\x73\127\x4a\x39\61\156\170\65\112\x32\x41\142\x63\x52"; private $p98DP = "\65\163\x58\x26\x4a\x55\165\x57\110\164\x72\170\162\51\66\101\60\172\137\102\161\127\x4c\x78\x4e\x54\161\113\132\51\107\x28\141\x50\107\43\106\x72\x2d\x58"; private $Vmt25 = "\x74\162\151\x61\x6c"; private $pghuc = License::INACTIVE_STATE; private $Temjj = "\x6f\156\145\137\x6f\x66\146"; private $sQ3HQ; private $xaKfh; private $iEcMA; private $dZfa1; private $Zm8Ju; private $ecBNT; private $m7RHB; private $S9TL8; private $YgXjD; private $EBx_u; private $grW4j; private $GChSK; private $Azy9Z; private $qeKF_; private $lk4bg; private $Z8Tjn; private $LAB4q; private final function __construct() { goto xxK5_; xxK5_: $this->lk4bg = \Magento\Framework\App\ObjectManager::getInstance()->get(\Magento\Framework\App\Filesystem\DirectoryList::class); goto FrdVS; oYt2Q: $this->S9TL8 = \Magento\Framework\App\ObjectManager::getInstance()->get(\Psr\Log\LoggerInterface::class); goto FIiMc; imesP: $this->GChSK = "\70\65\x62\x62\x33\x65\61\x36\x35\65\63\65\x35\142\x66\x35\x31\66\x31\144\64\62\x66\x38\64\x33\71\x63\x33\x62\x36\60\x66\141\61\x62\61\x61\71\67"; goto DYslf; QLv00: $this->YgXjD = \Magento\Framework\App\ObjectManager::getInstance()->create(\Cart2Quote\License\Cache\Type\License::class); goto i8bNI; DYslf: $this->Azy9Z = "\63\x38\60\x35\141\71\x64\x66\x36\x36\142\66\144\144\x63\143\x33\66\x64\x65\61\x39\145\143\x39\x66\x39\146\144\x34\x61\x39\67\x31\63\x34\145\x36\x61\x30\141\71\64\63\x62\x62\x38\66\x39\x37\143\x66\x63\70\141\143\x63\143\61\x66\63\x38\x62\61"; goto mVFMJ; FIiMc: $this->grW4j = \Magento\Framework\App\ObjectManager::getInstance()->get(\Cart2Quote\License\Model\Session::class); goto AdE7y; AdE7y: $this->LAB4q = \Magento\Framework\App\ObjectManager::getInstance()->get(\Magento\Framework\Filesystem\Io\File::class); goto imesP; FrdVS: $this->qeKF_ = \Magento\Framework\App\ObjectManager::getInstance()->create(\Magento\Framework\Math\Random::class); goto QLv00; mVFMJ: $this->init(); goto E5lBI; i8bNI: $this->m7RHB = \Magento\Framework\App\ObjectManager::getInstance()->get(\Magento\Backend\Model\UrlInterface::class); goto oYt2Q; E5lBI: } private final function init() { goto iqvcW; ucHSr: $R4x2B = $this->getTempPath($this->getRandomTempFileName()); goto hhApf; hhApf: $this->storeFilePathInSession($R4x2B); goto evrIi; qGSQd: vLZDV: goto p2Nng; p2Nng: if (!(!isset($HZxpW) || $HZxpW["\x64\141\164\x65"] !== date("\131\55\x6d\x2d\x64"))) { goto gDyOx; } goto pse72; iqvcW: $R4x2B = $this->getFilePathFromSession(); goto mkXiR; Zlz9S: if (!isset($HZxpW)) { goto vLZDV; } goto C6MZV; evrIi: WN1V2: goto B_Iuw; mxSsW: $this->storeInCache($n8iCM); goto PbTJC; pse72: $this->fetchLicenseData($n8iCM); goto mxSsW; juAV5: $HZxpW = $this->getFromCache(); goto Zlz9S; mkXiR: if (!(!$R4x2B || !file_exists($R4x2B))) { goto WN1V2; } goto ucHSr; C6MZV: $n8iCM = array_merge($n8iCM, $HZxpW); goto qGSQd; wEGuO: $this->setLicenseProperties($n8iCM); goto WNDva; B_Iuw: $n8iCM = ["\144\x61\164\145" => date("\131\55\155\55\x64"), "\145\x64\x69\x74\151\157\x6e" => $this->Vmt25, "\154\151\x63\x65\156\x73\x65\123\164\141\x74\145" => $this->pghuc, "\154\151\x63\145\156\163\x65\124\x79\x70\145" => $this->Temjj]; goto juAV5; PbTJC: gDyOx: goto wEGuO; WNDva: } private final function setLicenseProperties($Hh5m7) { goto y1kin; TE5FY: foreach ($IsA1n as $so3uD) { goto fAGCU; C8TDz: s7Xgd: goto W0Yrc; qVWjO: P7V0M: goto C8TDz; fAGCU: if (!isset($Hh5m7[$so3uD])) { goto P7V0M; } goto abe1A; abe1A: $this->{$so3uD} = $Hh5m7[$so3uD]; goto qVWjO; W0Yrc: } goto BDqkV; BDqkV: GRgh2: goto k8vk1; y1kin: $IsA1n = ["\154\x69\x63\145\x6e\163\x65\123\164\x61\x74\x65", "\154\x69\143\145\156\x73\x65\x54\171\160\145", "\x65\x78\160\151\x72\171\x44\141\x74\x65", "\145\x64\151\164\151\157\156", "\160\x72\x6f\160\157\163\141\x6c\101\155\x6f\165\156\x74", "\x6f\162\x64\145\x72\x49\144"]; goto TE5FY; k8vk1: } private final function getSessionDataName() { return hash("\163\x68\141\x32\65\66", "\154\141\x73\x74\137\146\141\x69\x6c\x65\144\137\141\x74\x74\x65\155\160\x74\x5f\x64\x61\164\x65"); } private final function encrypt($n8iCM, $NJb7U = null, $LI6U4 = null) { goto xuv0g; MARHk: $NJb7U = $this->GChSK; goto td5kW; sxj4f: $LI6U4 = $this->Azy9Z; goto jUuwU; td5kW: Db7mV: goto H_qXW; xuv0g: if ($NJb7U) { goto Db7mV; } goto MARHk; zAWwy: return \Cart2Quote\License\Security\Security::encrypt($n8iCM, $NJb7U, $LI6U4); goto zlBZ_; jUuwU: xj2WP: goto zAWwy; H_qXW: if ($LI6U4) { goto xj2WP; } goto sxj4f; zlBZ_: } private final function getTempPath($Bv01X) { return sprintf("\45\163" . DIRECTORY_SEPARATOR . "\45\163", rtrim($this->lk4bg->getPath(\Magento\Framework\App\Filesystem\DirectoryList::TMP), DIRECTORY_SEPARATOR), ltrim($Bv01X, DIRECTORY_SEPARATOR)); } private final function getRandomTempFileName() { return sprintf("\x2e\x25\163", $this->qeKF_->getRandomString(10, \Magento\Framework\Math\Random::CHARS_LOWERS)); } private final function getFromCache() { goto EXb8h; hBqx_: if ($f98TM) { goto ZKIVN; } goto KuF3T; OL8rY: return json_decode($zSl1M, true); goto pMI0L; EXb8h: $f98TM = $this->YgXjD->load($this->f1Xdh); goto hBqx_; b8NVF: $zSl1M = $this->decrypt($f98TM, $this->UNlJY, $this->p98DP); goto OL8rY; ToPvQ: ZKIVN: goto b8NVF; KuF3T: return null; goto ToPvQ; pMI0L: } private final function decrypt($n8iCM, $NJb7U = null, $LI6U4 = null) { goto fp7aV; D00Zr: $LI6U4 = $this->Azy9Z; goto G9pcp; G9pcp: hk9MY: goto QYOj0; wXCb9: if ($LI6U4) { goto hk9MY; } goto D00Zr; jrvAc: $NJb7U = $this->GChSK; goto ANaMJ; ANaMJ: FICAc: goto wXCb9; fp7aV: if ($NJb7U) { goto FICAc; } goto jrvAc; QYOj0: return \Cart2Quote\License\Security\Security::decrypt($n8iCM, $NJb7U, $LI6U4); goto Y2THp; Y2THp: } private final function fetchLicenseData(&$n8iCM) { try { goto iBZD1; OffnC: if (!isset($Hh5m7["\144\157\x6d\x61\x69\x6e"]["\154\x69\x63\145\156\163\x65"], $Hh5m7["\144\x6f\155\141\151\x6e"]["\x6c\x69\x63\145\156\x73\145"]["\145\144\151\164\x69\x6f\156\137\151\144"], $Hh5m7["\144\157\155\x61\x69\156"]["\x6c\x69\x63\145\156\x73\145"]["\x6c\x69\x63\x65\156\x73\145\137\163\164\x61\x74\x65\x5f\x69\x64"], $Hh5m7["\144\x6f\155\141\151\x6e"]["\x6c\151\143\145\156\163\x65"]["\154\151\x63\x65\x6e\163\145\x5f\164\x79\x70\x65\137\151\x64"])) { goto kgqge; } goto TI0C_; ZMwtf: $Hh5m7 = json_decode($Hh5m7, true); goto OffnC; tPWlG: $n8iCM["\x6c\x69\143\x65\x6e\x73\145\x53\x74\x61\x74\x65"] = $Hh5m7["\x64\x6f\x6d\141\x69\156"]["\154\x69\x63\x65\156\163\145"]["\154\x69\x63\x65\x6e\x73\x65\x5f\163\x74\141\164\145\137\151\x64"]; goto TcDz2; CJl2C: $this->resetFailedAttempt(); goto Y6ehY; PS_vD: $Hh5m7 = $this->decrypt($Hh5m7); goto ZMwtf; gfC8N: $n8iCM["\145\x78\160\151\x72\171\x44\141\164\145"] = $Hh5m7["\144\x6f\x6d\141\x69\x6e"]["\x6c\151\x63\145\156\x73\145"]["\x6c\151\143\145\x6e\x73\x65\137\x65\x78\x70\x69\x72\171\x5f\x64\x61\164\145"]; goto nCC0r; Y6ehY: kgqge: goto WRwR2; nCC0r: $n8iCM["\x65\144\151\x74\151\x6f\x6e"] = $Hh5m7["\144\157\155\x61\151\x6e"]["\x6c\151\x63\145\x6e\163\145"]["\145\x64\151\x74\151\x6f\156\137\x69\144"]; goto Vxve_; TI0C_: $n8iCM["\x64\x61\164\145"] = date("\x59\x2d\x6d\55\x64"); goto tPWlG; TcDz2: $n8iCM["\154\151\143\x65\x6e\163\x65\x54\x79\160\145"] = $Hh5m7["\144\x6f\155\x61\x69\x6e"]["\x6c\151\x63\x65\156\163\145"]["\154\151\143\145\156\163\145\x5f\164\171\160\x65\137\x69\144"]; goto gfC8N; Vxve_: $n8iCM["\160\162\x6f\160\157\x73\x61\x6c\x41\x6d\157\165\156\x74"] = $Hh5m7["\144\x6f\x6d\x61\151\x6e"]["\160\162\157\160\157\x73\141\154\163\137\163\145\x6e\x74"]; goto fproR; iBZD1: $Hh5m7 = \Cart2Quote\License\Http\Client::getInstance()->getLicense(); goto PS_vD; fproR: $n8iCM["\x6f\162\144\x65\162\111\x64"] = isset($Hh5m7["\144\157\x6d\x61\151\x6e"]["\x6c\151\x63\145\156\163\145"]["\157\x72\144\x65\x72\137\151\x64"]) ? $Hh5m7["\144\x6f\155\141\151\156"]["\154\x69\x63\145\x6e\x73\145"]["\157\162\x64\x65\162\137\151\144"] : null; goto CJl2C; WRwR2: } catch (\Exception $X8gf1) { goto fz_wE; LcnOE: OCdvy: goto vQ2Qt; vQ2Qt: $n8iCM["\154\x69\x63\145\x6e\x73\x65\123\x74\x61\164\x65"] = License::INACTIVE_STATE; goto r9_0c; UBEzq: $n8iCM["\x65\144\151\x74\151\x6f\x6e"] = $n8iCM["\154\x69\x63\x65\156\163\145\x54\x79\x70\145"] = $n8iCM["\x6c\151\143\x65\x6e\163\145\x53\x74\141\x74\x65"] = License::UNREACHABLE; goto AsGGJ; fz_wE: $aIex9 = $this->getFailedAttemptDate(); goto BysWx; BysWx: if ($aIex9 && strtotime($aIex9) <= strtotime("\55\67\40\x64\x61\171")) { goto OCdvy; } goto UBEzq; r9_0c: HrXSK: goto mk8CZ; AsGGJ: goto HrXSK; goto LcnOE; mk8CZ: $this->failedAttempt(); goto T416_; T416_: } } private final function getFilePathFromSession() { goto bcyv4; JTvWL: if (isset($gBszY)) { goto DFWCo; } goto UMhqW; bcyv4: $gBszY = $this->grW4j->getSessionData($this->getSessionDataName()); goto JTvWL; J9tJP: return $this->decrypt($gBszY); goto wmDQU; UMhqW: return false; goto vhcYP; vhcYP: DFWCo: goto J9tJP; wmDQU: } private final function storeFilePathInSession($gBszY) { $this->grW4j->setSessionData($this->getSessionDataName(), $this->encrypt($gBszY)); } private final function resetFailedAttempt() { goto m7eCP; yaKzf: if (!file_exists($Rx2QM)) { goto IWDze; } goto SSNoL; SSNoL: unlink($Rx2QM); goto eVeUf; m7eCP: $Rx2QM = $this->getFilePathFromSession(); goto yaKzf; eVeUf: IWDze: goto OFdER; OFdER: } private final function getFailedAttemptDate() { try { goto tYeh8; QML5H: return $this->decrypt(file_get_contents($gBszY)); goto O4LMl; O4LMl: VBb72: goto nCyhK; FD_yq: if (!file_exists($gBszY)) { goto VBb72; } goto QML5H; tYeh8: $gBszY = $this->getFilePathFromSession(); goto FD_yq; nCyhK: } catch (\Exception $AJD0I) { } return null; } private final function failedAttempt() { goto Rto_K; Rto_K: $vlcPZ = date("\x59\55\x6d\55\x64"); goto RRMak; RRMak: try { goto k7B0T; y3caT: JPGAI: goto Dbt4s; ufSAm: $this->LAB4q->checkAndCreateFolder($E4SVF); goto y3caT; k7B0T: $E4SVF = $this->lk4bg->getPath(\Magento\Framework\App\Filesystem\DirectoryList::TMP); goto UzScO; UzScO: if (is_dir($E4SVF)) { goto JPGAI; } goto ufSAm; Dbt4s: @file_put_contents($this->getFilePathFromSession(), $this->encrypt($vlcPZ)); goto g40tY; g40tY: } catch (\Exception $AJD0I) { } goto TqoP6; TqoP6: return $vlcPZ; goto vkGTv; vkGTv: } private final function storeInCache($f98TM) { goto YxhVS; YxhVS: $z1144 = json_encode($f98TM); goto rJquE; rJquE: $nRjDD = $this->encrypt($z1144, $this->UNlJY, $this->p98DP); goto bqW3L; bqW3L: $this->YgXjD->save($nRjDD, $this->f1Xdh); goto EY4mX; EY4mX: } public final function getDomain() { goto nev7w; Uxt91: $this->sQ3HQ = parse_url($this->m7RHB->getBaseUrl(), PHP_URL_HOST); goto CxSvR; XP6XK: return $this->sQ3HQ; goto VzxC9; nev7w: if (isset($this->sQ3HQ)) { goto LhhgT; } goto Uxt91; CxSvR: LhhgT: goto XP6XK; VzxC9: } public final function getEdition() { goto AmHCn; cqkKC: $this->{"\145\x64\151\x74\151\x6f\156"} = $this->Vmt25; goto Hw7HE; Hw7HE: PmcBV: goto qP62O; qP62O: return $this->{"\x65\144\x69\164\151\157\156"}; goto Fg_PU; AmHCn: if (isset($this->{"\145\144\151\x74\151\x6f\156"})) { goto PmcBV; } goto cqkKC; Fg_PU: } public final function isActiveState() { return $this->getLicenseState() == License::ACTIVE_STATE; } public final function getLicenseState() { goto gsSo6; gsSo6: if (!(!isset($this->{"\x6c\x69\143\145\x6e\163\x65\x53\x74\141\x74\x65"}) || !License::isValid())) { goto WucUe; } goto QCr2a; QCr2a: return $this->pghuc; goto DgeQw; DgeQw: WucUe: goto RbwX1; RbwX1: return $this->{"\x6c\151\x63\x65\156\x73\x65\123\x74\x61\164\145"}; goto uZPXc; uZPXc: } public final function getLicenseType() { goto Z59Pd; g1ZEt: return $this->Temjj; goto Qo7Vr; Ij9OE: return $this->{"\154\151\143\145\156\163\x65\x54\171\x70\x65"}; goto csY2g; Z59Pd: if (isset($this->{"\154\x69\143\145\x6e\x73\145\x54\x79\x70\145"})) { goto YCV_M; } goto g1ZEt; Qo7Vr: YCV_M: goto Ij9OE; csY2g: } public static final function isValid() { goto N957c; G0tHA: try { goto o2GPc; FDH1g: $LoP30 = $vaLyz->getAllPlugins(); goto toEA7; o2GPc: $UBcQE = self::getInstance(); goto GOjWT; oGqHh: if (!($vaLyz === null)) { goto L5KZP; } goto MIAmN; MIAmN: $PnlN_ = get_class($UBcQE); goto zKGpD; aTYK5: return false; goto jAj1b; zKGpD: $UBcQE->S9TL8->error("\x43\141\x72\164\x32\x51\165\157\164\145\x3a\x20\x54\x68\x65\x20\143\x6c\x61\163\163\x3a\x20" . $PnlN_ . "\40\156\145\145\144\163\x20\x61\x20\143\150\145\143\x6b\40\146\x6f\x72\72\x20" . get_called_class()); goto aTYK5; jAj1b: L5KZP: goto FDH1g; GOjWT: $vaLyz = \Cart2Quote\Features\Feature\FeatureList::getInstance($UBcQE); goto oGqHh; toEA7: } catch (\Exception $AJD0I) { $BYfgV = "\101\x66\164\x65\162\x20\151\156\163\164\x61\154\x6c\x69\156\147\x20\x43\141\162\164\x32\x51\x75\x6f\164\145\40\x72\165\x6e\40\x22\142\x69\x6e\57\155\141\x67\145\156\164\157\40\163\145\164\x75\x70\x3a\x75\160\147\162\x61\x64\x65\42\x20\142\x65\x66\x6f\162\145\x20\160\162\x6f\x63\145\x65\x64\x69\156\147\56"; throw new \Magento\Framework\Exception\LocalizedException(ZOhAD($BYfgV)); } goto Uqk4f; Y3Htx: KJnFG: goto G0tHA; myqN6: $E6g0P = true; goto vYSuU; pf47b: return self::getInstance()->EBx_u = $E6g0P; goto eUvAu; Uqk4f: $SJGlp = \Magento\Framework\App\ObjectManager::getInstance()->get(\Magento\Framework\Interception\PluginList\PluginList::class); goto myqN6; N957c: if (!(self::getInstance()->getDomain() == "\154\x6f\x63\141\154\x68\x6f\x73\x74")) { goto pX5B5; } goto O43Zo; O43Zo: return true; goto hdQje; dHrGP: return true; goto Y3Htx; I45ud: CURqt: goto pf47b; vYSuU: foreach ($LoP30 as $vnKFB => $XRXld) { goto MrBUV; Ro2Ph: NUzWe: goto GPwMP; U0dOu: ZaYko: goto Ro2Ph; MrBUV: foreach ($XRXld["\160\154\x75\x67\151\x6e\x73"] as $SlHuK => $Txepw) { goto UN1He; Z1FY0: Ka2q3: goto bdO2A; xDALD: SpRl0: goto Z1FY0; xyWsi: goto ZaYko; goto xDALD; EKxd2: $E6g0P = false; goto xyWsi; UN1He: if ($SJGlp->isPluginLoaded($vnKFB, $Txepw["\151\x6e\x73\164\141\x6e\x63\x65"])) { goto SpRl0; } goto EKxd2; bdO2A: } goto U0dOu; GPwMP: } goto I45ud; hdQje: pX5B5: goto t1YKb; t1YKb: if (!self::getInstance()->EBx_u) { goto KJnFG; } goto dHrGP; eUvAu: } public static final function getInstance() { goto ETQwU; FcYgP: if (!($GxhKZ === null)) { goto TjkrE; } goto jFqNe; hVKX1: TjkrE: goto NWd1T; NWd1T: return $GxhKZ; goto bk1sZ; ETQwU: static $GxhKZ = null; goto FcYgP; jFqNe: $GxhKZ = new License(); goto hVKX1; bk1sZ: } public final function isInactiveState() { return $this->getLicenseState() == License::INACTIVE_STATE; } public final function isPendingState() { return $this->getLicenseState() == License::PENDING_STATE; } public final function isUnreachable() { return $this->getLicenseState() == License::UNREACHABLE; } public final function isUnreachableState() { return $this->isUnreachable(); } public final function setProposalSent() { goto l2zY2; l2zY2: if (!($this->getEdition() == "\x6c\x69\x74\145")) { goto iiPE6; } goto E8qjq; E8qjq: \Cart2Quote\License\Http\Client::getInstance()->setProposalSent(); goto hVpe3; hVpe3: $this->invalidateCache(); goto gNm91; gNm91: iiPE6: goto v1Mgg; v1Mgg: } public final function getProposalAmount() { return @$this->{"\x70\162\x6f\160\157\x73\x61\154\101\x6d\x6f\165\156\164"}; } private final function invalidateCache() { $this->YgXjD->remove($this->f1Xdh); } public final function reload() { $this->invalidateCache(); $this->init(); } public function getExpiryDate() { return @$this->{"\145\x78\x70\151\162\x79\x44\x61\164\145"}; } public function getOrderId() { return @$this->{"\157\x72\x64\x65\x72\x49\x64"}; } public final function isAllowedForEdition($ceao6 = "\157\x70\x65\156\163\157\165\x72\143\x65") { $bMwXk = \Cart2Quote\License\Feature\Feature::getInstance($this); return $bMwXk->isAllowedForEdition($ceao6); } }