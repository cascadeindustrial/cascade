<?php /** * @author Amasty Team * @copyright Copyright (c) 2020 Amasty (https://www.amasty.com) * @package Amasty_Xnotif */ ?> <?php /** @var Magento\Framework\Url\Helper\Data $urlHelper */ $urlHelper = $this->helper(\Magento\Framework\Url\Helper\Data::class); /** @var Amasty\Xnotif\Helper\Data $helper */ $helper = $this->helper(\Amasty\Xnotif\Helper\Data::class); $productId = (int)$helper->getOriginalProduct($block)->getId(); $parentId = (int)$block->getData('parent_product_id'); $url = $block->escapeHtml($helper->getEmailUrl('stock')); ?> <div class="amxnotif-block" data-action="<?= /* @noEscape */ $url; ?>"><form id="form-validate-stock" method="post" action="<?= /* @noEscape */ $url; ?>"><label for="notification-container-<?= /* @noEscape */ $productId ?>"><?= /* @noEscape */ __('Subscribe to get alert when the product is back in stock') ?></label> <div class="notification-container" id="notification-container-<?= /* @noEscape */ $productId ?>"><div class="input-fields fieldset"><div class="error-msg"><input name="guest_email" class="input-text amxnotif-guest-email" id="amxnotif-guest-email-<?= /* @noEscape */ $productId ?>" size="30" type="email" data-validate="{required:true, 'validate-email':true}" placeholder="<?= $block->escapeHtml("Enter your email address") ?>" /><input type="hidden" name="product_id" value="<?= /* @noEscape */ $productId ?>"/><input type="hidden" name="type" value="email"/><?php if ($parentId):?> <input type="hidden" name="parent_id" value="<?= /* @noEscape */ $parentId ?>"/><?php endif; ?> <input type="hidden" name="form_key" value="<?= $block->escapeHtmlAttr($helper->getFormKey()) ?>"><div class="actions-toolbar amxnotif_guest_action"><div class="primary"><button type="submit" class="action submit primary"><span class="subscribe-stock"><?= $block->escapeHtml(__('Notify Me')); ?></span></button></div></div></div><input type="hidden" name="<?= /* @noEscape */ \Magento\Framework\App\Action\Action::PARAM_NAME_URL_ENCODED ?>" value="<?= /* @noEscape */ $urlHelper->getEncodedUrl(); ?>"/><?php if ($helper->isGDRPEnabled()): ?> <div class="field required"><input type="checkbox" name="gdrp" id="amxnotif-stock-gdrp-<?= /* @noEscape */ $productId ?>" title="<?= $block->escapeHtml(__('GDRP')); ?>" data-validate="{required:true}" value="1"><label class="label" for="amxnotif-stock-gdrp-<?= /* @noEscape */ $productId ?>"><?= /* @noEscape */ $helper->getGDRPText(); ?></label></div><?php endif; ?></div></div></form></div><script type="text/javascript">
    require([
        'jquery',
        "mage/mage",
        "mage/validation"
    ], function ($) {
        "use strict";
        $('#form-validate-stock').mage('validation');
    });</script>