define(['ko','jquery','uiComponent','prCookieRestriction','uiRegistry','Magento_Ui/js/modal/modal','text!Plumrocket_CookieConsent/template/notice/modal/modal-bottom.html','text!Plumrocket_CookieConsent/template/notice/modal/modal-popup.html','mage/translate','mage/cookies',],function(ko,$,Component,prCookieRestriction,uiRegistry,modal,modalBottomTpl,modalPopupTpl){'use strict';var DISPLAY_STYLE_POPUP='popup';var DISPLAY_STYLE_WALL='wall';var DISPLAY_STYLE_BOTTOM='bottom';return Component.extend({initialize:function(config){this._super();this.createModal=_.once(this.createModal);},autoOpen:function(){this.createModal();if(!prCookieRestriction.isOptIn()&&!this.isDisabled()){this.getModal().openModal();}
this.addStyles(this.design);this.addChangingStyleOnHover($('.pr-cookie-notice-btn.allow'),this.acceptButtonConfig);this.addChangingStyleOnHover($('.pr-cookie-notice-btn.decline'),this.declineButtonConfig);this.addChangingStyleOnHover($('.pr-cookie-setting-btn'),this.settingsButtonConfig);},allowAll:function(){prCookieRestriction.allowAllCategories();this.getModal().closeModal();},declineAll:function(){prCookieRestriction.declineAll();this.getModal().closeModal();},openSettings:function(){uiRegistry.get('pr-cookie-settings-bar').getModal().openModal();},getDisplayStyle:function(){return this.displayStyle;},createModal:function(){var options={buttons:[],modalClass:'pr-cookie-modal pr-cookie-modal-'+this.getDisplayStyle(),};switch(this.getDisplayStyle()){case DISPLAY_STYLE_BOTTOM:options=_.extendOwn(options,{customTpl:modalBottomTpl,type:'custom',overlayClass:'pr-cookie-overlay',parentModalClass:'',modalVisibleClass:'show-without-overlay',keyEventHandlers:{escapeKey:function(){}}});break;case DISPLAY_STYLE_WALL:options=_.extendOwn(options,{popupTpl:modalPopupTpl,type:'popup',clickableOverlay:false,canClose:false,title:this.noticeTitle,keyEventHandlers:{escapeKey:function(){}}});break;case DISPLAY_STYLE_POPUP:options=_.extendOwn(options,{popupTpl:modalPopupTpl,type:'popup',clickableOverlay:false,canClose:true,title:this.noticeTitle,modalCloseBtnHandler:this.disableNotice.bind(this),keyEventHandlers:{escapeKey:this.disableNotice.bind(this)}});break;}
this.modal=modal(options,document.getElementById('pr-cookie-notice'));},getModal:function(){this.createModal();return this.modal;},isDisabled:function(){return'close'===$.mage.cookies.get(this.statusCookieName);},disableNotice:function(){$.mage.cookies.set(this.statusCookieName,'close',{lifetime:86400});this.getModal().closeModal();},addChangingStyleOnHover:function($button,config){$button.hover(function(){$(this).css({'background-color':(config.type==='link')?'':config.background_color_on_hover,'border-color':(config.type==='link')?'':config.background_color_on_hover,'color':config.text_color_on_hover})},function(){$(this).css({'background-color':(config.type==='link')?'':config.background_color,'border-color':(config.type==='link')?'':config.background_color,'color':config.text_color});});},addStyles:function(design){if(design.titleColor){$('.pr-cookie-modal .modal-title').css({'color':design.titleColor});}
if(design.textColor){$('.pr-cookie-notice-text').css({'color':design.textColor});}
if(design.backgroundColor){$('.pr-cookie-modal > .modal-inner-wrap').css({'background-color':design.backgroundColor});}
if(design.backgroundColor){$('.pr-cookie-modal > .modals-overlay').css({'background-color':design.overlayBackgroundColor});}},});});